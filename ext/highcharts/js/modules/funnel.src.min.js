/**
 * @license 
 * Highcharts funnel module
 *
 * (c) 2010-2014 Torstein Honsi
 *
 * License: www.highcharts.com/license
 */
!function(t){"object"==typeof module&&module.exports?module.exports=t:t(Highcharts)}(function(t){"use strict"
var e=t.getOptions(),n=e.plotOptions,o=t.seriesTypes,i=t.merge,r=function(){},s=t.each,a=t.pick
n.funnel=i(n.pie,{animation:!1,center:["50%","50%"],width:"90%",neckWidth:"30%",height:"100%",neckHeight:"25%",reversed:!1,dataLabels:{connectorWidth:1,connectorColor:"#606060"},size:!0,states:{select:{color:"#C0C0C0",borderColor:"#000000",shadow:!1}}}),o.funnel=t.extendClass(o.pie,{type:"funnel",animate:r,translate:function(){var t,e,n,o,i,a,l,p,c,d,h,u=function(t,e){return/%$/.test(t)?e*parseInt(t,10)/100:parseInt(t,10)},f=0,g=this,b=g.chart,y=g.options,m=y.reversed,v=y.ignoreHiddenPoint,k=b.plotWidth,C=b.plotHeight,W=0,w=y.center,L=u(w[0],k),H=u(w[1],C),Y=u(y.width,k),x=u(y.height,C),A=u(y.neckWidth,k),O=u(y.neckHeight,C),P=H-x/2+x-O,T=g.data,X="left"===y.dataLabels.position?1:0
g.getWidthAt=e=function(t){var e=H-x/2
return t>P||x===O?A:A+(Y-A)*(1-(t-e)/(x-O))},g.getX=function(t,n){return L+(n?-1:1)*(e(m?C-t:t)/2+y.dataLabels.distance)},g.center=[L,H,x],g.centerX=L,s(T,function(t){v&&t.visible===!1||(f+=t.y)}),s(T,function(s){h=null,o=f?s.y/f:0,a=H-x/2+W*x,c=a+o*x,t=e(a),i=L-t/2,l=i+t,t=e(c),p=L-t/2,d=p+t,a>P?(i=p=L-A/2,l=d=L+A/2):c>P&&(h=c,t=e(P),p=L-t/2,d=p+t,c=P),m&&(a=x-a,c=x-c,h=h?x-h:null),n=["M",i,a,"L",l,a,d,c],h&&n.push(d,h,p,h),n.push(p,c,"Z"),s.shapeType="path",s.shapeArgs={d:n},s.percentage=100*o,s.plotX=L,s.plotY=(a+(h||c))/2,s.tooltipPos=[L,s.plotY],s.slice=r,s.half=X,v&&s.visible===!1||(W+=o)})},drawPoints:function(){var t=this,e=t.options,n=t.chart,o=n.renderer
s(t.data,function(n){var i=n.options,r=n.graphic,s=n.shapeArgs
r?r.animate(s):n.graphic=o.path(s).attr({fill:n.color,stroke:a(i.borderColor,e.borderColor),"stroke-width":a(i.borderWidth,e.borderWidth)}).add(t.group)})},sortByAngle:function(t){t.sort(function(t,e){return t.plotY-e.plotY})},drawDataLabels:function(){var t,e,n,i,r,s=this.data,a=this.options.dataLabels.distance,l=s.length
for(this.center[2]-=2*a;l--;)n=s[l],t=n.half,e=t?1:-1,r=n.plotY,i=this.getX(r,t),n.labelPos=[0,r,i+(a-5)*e,r,i+a*e,r,t?"right":"left",0]
o.pie.prototype.drawDataLabels.call(this)}}),e.plotOptions.pyramid=t.merge(e.plotOptions.funnel,{neckWidth:"0%",neckHeight:"0%",reversed:!0}),t.seriesTypes.pyramid=t.extendClass(t.seriesTypes.funnel,{type:"pyramid"})})
