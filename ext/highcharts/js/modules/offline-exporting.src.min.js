/**
 * @license Highcharts JS v4.2.1 (2015-12-21)
 * Client side exporting module
 *
 * (c) 2015 Torstein Honsi / Oystein Moseng
 *
 * License: www.highcharts.com/license
 */
!function(t){"object"==typeof module&&module.exports?module.exports=t:t(Highcharts)}(function(t){function e(t,e){var n=r.getElementsByTagName("head")[0],o=r.createElement("script")
o.type="text/javascript",o.src=t,o.onload=e,n.appendChild(o)}var n=t.win,o=n.navigator,r=n.document
t.CanVGRenderer={},t.Chart.prototype.exportChartLocal=function(a,i){var c,l,h,s,g,d=this,p=t.merge(d.options.exporting,a),m=o.userAgent.indexOf("WebKit")>-1&&o.userAgent.indexOf("Chrome")<0,u=p.scale||2,f=n.URL||n.webkitURL||n,v=0,w=function(){if(p.fallbackToExportServer===!1)throw"Fallback to export server disabled"
d.exportChart(p)},x=function(t,e,o,a,i,c,l){var h=new n.Image
m||(h.crossOrigin="Anonymous"),h.onload=function(){var n,c=r.createElement("canvas"),s=c.getContext&&c.getContext("2d")
if(s){c.height=h.height*u,c.width=h.width*u,s.drawImage(h,0,0,c.width,c.height)
try{n=c.toDataURL(),o(n,e)}catch(g){if("SecurityError"!==g.name&&"SECURITY_ERR"!==g.name&&"SecurityError"!==g.message)throw g
a(t,e)}}else i(t,e)
l&&l(t,e)},h.onerror=function(){c(t,e),l&&l(t,e)},h.src=t},y=function(t){try{if(!m&&o.userAgent.toLowerCase().indexOf("firefox")<0)return f.createObjectURL(new n.Blob([t],{type:"image/svg+xml;charset-utf-16"}))}catch(e){}return"data:image/svg+xml;charset=UTF-8,"+encodeURIComponent(t)},b=function(t,e){var a,i=r.createElement("a"),c=(p.filename||"chart")+"."+e
if(o.msSaveOrOpenBlob)return void o.msSaveOrOpenBlob(t,c)
if(void 0!==i.download)i.href=t,i.download=c,i.target="_blank",r.body.appendChild(i),i.click(),r.body.removeChild(i)
else try{if(a=n.open(t,"chart"),void 0===a||null===a)throw 1}catch(l){n.location.href=t}},C=function(){var a,i,l=d.sanitizeSVG(c.innerHTML)
if(p&&"image/svg+xml"===p.type)try{o.msSaveOrOpenBlob?(i=new MSBlobBuilder,i.append(l),a=i.getBlob("image/svg+xml")):a=y(l),b(a,"svg")}catch(h){w()}else a=y(l),x(a,{},function(t){try{b(t,"png")}catch(e){w()}},function(){var a=r.createElement("canvas"),i=a.getContext("2d"),c=l.match(/^<svg[^>]*width\s*=\s*\"?(\d+)\"?[^>]*>/)[1]*u,h=l.match(/^<svg[^>]*height\s*=\s*\"?(\d+)\"?[^>]*>/)[1]*u,s=function(){i.drawSvg(l,0,0,c,h)
try{b(o.msSaveOrOpenBlob?a.msToBlob():a.toDataURL("image/png"),"png")}catch(t){w()}}
a.width=c,a.height=h,n.canvg?s():(d.showLoading(),e(t.getOptions().global.canvasToolsURL,function(){d.hideLoading(),s()}))},w,w,function(){try{f.revokeObjectURL(a)}catch(t){}})},O=function(t,e){++v,e.imageElement.setAttributeNS("http://www.w3.org/1999/xlink","href",t),v===l.length&&C()}
t.wrap(t.Chart.prototype,"getChartHTML",function(t){return c=this.container.cloneNode(!0),t.apply(this,Array.prototype.slice.call(arguments,1))}),d.getSVGForExport(p,i),l=c.getElementsByTagName("image")
try{for(l.length||C(),s=0,g=l.length;g>s;++s)h=l[s],x(h.getAttributeNS("http://www.w3.org/1999/xlink","href"),{imageElement:h},O,w,w,w)}catch(L){w()}},t.getOptions().exporting.buttons.contextButton.menuItems=[{textKey:"printChart",onclick:function(){this.print()}},{separator:!0},{textKey:"downloadPNG",onclick:function(){this.exportChartLocal()}},{textKey:"downloadSVG",onclick:function(){this.exportChartLocal({type:"image/svg+xml"})}}]})
